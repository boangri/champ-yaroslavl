# Прогнозирование риска развития сердечно-сосудистого заболевания пациента

**Чемпионат Ярославская область**

## Краткое описание решения:

### Подготовка данных.
Бинарные фичи были преобразованы в (0, 1)

Категориальные фичи были закодированы как OHE. При этом, по причине малой статистики, были отброшены фичи с 
большим числом классов и предположительно мало влияющие на предсказание (например, религия или профессия)

Продолжительность сна была отнормирована на среднее 0 и дисперсия 1.

### Нахождение оптимальных гиперпараметров
На первом этапе для каждой болезни (5) подбиралась оптимальная архитектура и гиперпараметры.  
Исследовались полносвязные архитектуры из 1 и 2 слоев. 

В качестве инструмента использовался пакет hyperopt и генетический алгоритм. 

В качестве критерия отбора пробовались val_loss и recall.

Были проведены исследования для выбора оптимального порогового значения вероятностей для каждой болезни.
Далее для каждой из найденных оптимальных архитектрур подбирались оптимальные начальные веса.

Для получения наиболее представительной оценки качества моделей использовалась кросс-валидация с числом фолдов = 5.

## Технические особенности

Наиболее ресурсоемким этапом являлся этап нахождения оптимальных архитектур. Эти вычисления делались в ноутбуках
с использованием GPU. `hyperout-yarosl.ipynb`

Предсказание (CSV-файл для сабмита) делалось в программе `make_csv.py`

Использовались keras, hyperopt, самописные классы для генетического алгоритма. 

Работы проводились на ресурсах Google colab и Kaggle.